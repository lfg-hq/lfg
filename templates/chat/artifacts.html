<!-- Artifacts Panel -->
<div class="artifacts-container" id="artifacts-panel">
    <div class="resize-handle" id="resize-handle"></div>
    
    <!-- Top accent bar for smoothening effect -->
    <div style="height: 3px; background: linear-gradient(90deg, #8b5cf6, #a855f7, #c084fc); opacity: 0.8;"></div>
    
    <!-- Add specific styles for the apps tab -->
    <style>
        #apps.tab-pane {
            padding: 0 !important;
        }
        .artifacts-content {
            height: calc(100% - 40px); /* Adjust for tabs height */
        }
        .tab-content {
            height: 100%;
        }
        .tab-pane {
            height: 100%;
            position: relative;
        }
    </style>
    
    <!-- Tabs Navigation - moved to top -->
    <div class="artifacts-tabs" style="display: flex; justify-content: space-between; align-items: center;">
        <div style="display: flex;">
            <button class="tab-button active" data-tab="prd">PRD</button>
            <button class="tab-button" data-tab="implementation">Implementation</button>
            <!-- <button class="tab-button" data-tab="features">Features</button> -->
            <!-- <button class="tab-button" data-tab="personas">Personas</button> -->
            <!-- <button class="tab-button" data-tab="design">Design</button> -->
            <!-- <button class="tab-button" data-tab="tickets">Tickets</button> -->
            <button class="tab-button" data-tab="checklist">Task List</button>
            <button class="tab-button" data-tab="apps">Preview</button>
            <button class="tab-button" data-tab="toolhistory">Tool History</button>
            <button class="tab-button" data-tab="codebase">Codebase</button>
        </div>
        
        <button class="panel-arrow-right" id="artifacts-toggle" style="margin-left: auto; padding: 8px; background: none; border: none; color: #ccc; cursor: pointer;">
            <i class="fas fa-chevron-right"></i>
        </button>
    </div>
    
    <div class="artifacts-content">
        <!-- Tab Content -->
        <div class="tab-content">
            <!-- PRD Tab -->
            <div class="tab-pane active" id="prd">
                <div class="empty-state">
                    <div class="empty-state-icon">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <div class="empty-state-text">
                        No PRD content available yet.
                    </div>
                </div>
            </div>

            <!-- Implementation Tab -->
            <div class="tab-pane" id="implementation">
                <div class="empty-state">
                    <div class="empty-state-icon">
                        <i class="fas fa-code"></i>
                    </div>
                    <div class="empty-state-text">
                        No implementation plan available yet.
                    </div>
                </div>
                <!-- Implementation content will be loaded dynamically -->
            </div>

            <!-- Features Tab -->
            <div class="tab-pane" id="features">
                <div class="empty-state">
                    <div class="empty-state-icon">
                        <i class="fas fa-list-check"></i>
                    </div>
                    <div class="empty-state-text">
                        No features defined yet.
                    </div>
                </div>
            </div>

            <!-- Personas Tab -->
            <div class="tab-pane" id="personas">
                <div class="empty-state">
                    <div class="empty-state-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="empty-state-text">
                        No personas created yet.
                    </div>
                </div>
            </div>

            <!-- Design Tab -->
            <div class="tab-pane" id="design">
                <div class="design-container" style="width: 100%; height: 100%; position: absolute; top: 0; left: 0; right: 0; bottom: 0;">
                    <div class="loading-state" id="design-loading" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                        <div class="spinner"></div>
                        <div>Loading design elements...</div>
                    </div>
                    <div class="empty-state" id="design-empty" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                        <div class="empty-state-icon">
                            <i class="fas fa-palette"></i>
                        </div>
                        <div class="empty-state-text">
                            No design artifacts available yet.
                        </div>
                    </div>
                    <div class="design-frame-container" id="design-frame-container" style="display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; right: 0; bottom: 0;">
                        <iframe id="design-iframe" style="width: 100%; height: 100%; border: none;" sandbox="allow-same-origin"></iframe>
                    </div>
                </div>
            </div>

            <!-- Tickets Tab -->
            <div class="tab-pane" id="tickets">
                <div class="empty-state">
                    <div class="empty-state-icon">
                        <i class="fas fa-ticket"></i>
                    </div>
                    <div class="empty-state-text">
                        No tickets created yet.
                    </div>
                </div>
                <!-- Ticket content will be loaded dynamically -->
            </div>

            <!-- Checklist Tab -->
            <div class="tab-pane" id="checklist">
                <div class="empty-state">
                    <div class="empty-state-icon">
                        <i class="fas fa-check-square"></i>
                    </div>
                    <div class="empty-state-text">
                        No checklist items created yet.
                    </div>
                </div>
                <!-- Checklist content will be loaded dynamically -->
            </div>

            <!-- Apps Tab -->
            <div class="tab-pane" id="apps">
                <div class="app-container" style="width: 100%; height: 100%; display: flex; flex-direction: column;">
                    <!-- URL Panel -->
                    <div class="app-url-panel" id="app-url-panel" style="display: none; background: #2a2a2a; border-bottom: 1px solid #333;">
                        <div style="display: flex; align-items: center; gap: 10px; padding: 10px;">
                            <div style="flex: 1; display: flex; align-items: center; background: #1a1a1a; border: 1px solid #333; border-radius: 4px; padding: 0 10px;">
                                <i class="fas fa-globe" style="color: #666; margin-right: 8px;"></i>
                                <input type="text" id="app-url-input" 
                                       style="flex: 1; background: transparent; border: none; color: #e2e8f0; padding: 8px 0; outline: none;" 
                                       value=""
                                       placeholder="Enter URL...">
                            </div>
                            <button id="app-refresh-btn" class="btn btn-sm" 
                                    style="padding: 8px 16px; background: #4a5568; color: white; border: none; border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                            <button id="app-restart-server-btn" class="btn btn-sm" 
                                    style="padding: 8px 16px; background: #8b5cf6; color: white; border: none; border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                                <i class="fas fa-server"></i> Restart Server
                            </button>
                        </div>
                    </div>
                    
                    <!-- Content Area -->
                    <div style="flex: 1; position: relative;">
                        <div class="loading-state" id="app-loading" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                            <div class="spinner"></div>
                            <div>Loading app...</div>
                        </div>
                        <div class="empty-state" id="app-empty" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 100%; text-align: center;">
                            <div class="empty-state-icon">
                                <i class="fas fa-cube"></i>
                            </div>
                            <div class="empty-state-text">
                                No running apps available for this project.
                            </div>
                        </div>
                        <div class="app-frame-container" id="app-frame-container" style="display: none; width: 100%; height: 100%; flex-direction: column;">
                            <div style="flex: 1; position: relative;">
                                <iframe id="app-iframe" style="width: 100%; height: 100%; border: none;" 
                                        sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-modals allow-top-navigation-by-user-activation"></iframe>
                            </div>
                            
                            <!-- Console Panel -->
                            <div id="console-panel" style="height: 200px; background: #1a1a1a; border-top: 1px solid #333; display: none; flex-direction: column;">
                                <div style="padding: 8px; background: #2a2a2a; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center;">
                                    <span style="color: #e2e8f0; font-size: 14px; font-weight: 500;">
                                        <i class="fas fa-terminal"></i> Console
                                    </span>
                                    <div style="display: flex; gap: 10px;">
                                        <button id="pipe-console-btn" style="background: none; border: none; color: #999; cursor: pointer; padding: 4px 8px;" title="Send console logs to chat">
                                            <i class="fas fa-paper-plane"></i> Send to Chat
                                        </button>
                                        <button id="clear-console-btn" style="background: none; border: none; color: #999; cursor: pointer; padding: 4px 8px;">
                                            <i class="fas fa-trash"></i> Clear
                                        </button>
                                        <button id="toggle-console-btn" style="background: none; border: none; color: #999; cursor: pointer; padding: 4px 8px;">
                                            <i class="fas fa-chevron-down"></i>
                                        </button>
                                    </div>
                                </div>
                                <div id="console-output" style="flex: 1; overflow-y: auto; padding: 10px; font-family: 'Monaco', 'Consolas', monospace; font-size: 12px;">
                                    <!-- Console logs will appear here -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Console Toggle Button -->
                        <button id="show-console-btn" style="position: absolute; bottom: 10px; right: 10px; background: #2a2a2a; border: 1px solid #333; border-radius: 4px; padding: 8px 12px; color: #e2e8f0; cursor: pointer; display: none;">
                            <i class="fas fa-terminal"></i> Console
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Tool History Tab -->
            <div class="tab-pane" id="toolhistory">
                <div class="toolhistory-container" style="height: 100%; display: flex; flex-direction: column;">
                    <div class="toolhistory-header" style="padding: 15px; border-bottom: 1px solid #2a2a2a;">
                        <h3 style="margin: 0 0 10px 0; color: #e2e8f0;">Tool Call History</h3>
                        <div class="toolhistory-filters" style="display: flex; gap: 10px;">
                            <input type="text" id="tool-filter" placeholder="Filter by tool name..." 
                                   style="flex: 1; padding: 8px; background: #1a1a1a; border: 1px solid #333; border-radius: 4px; color: #e2e8f0;">
                            <button id="refresh-toolhistory" class="btn btn-sm" 
                                    style="padding: 8px 16px; background: #8b5cf6; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    </div>
                    <div class="toolhistory-content" style="flex: 1; overflow-y: auto; padding: 15px;">
                        <div class="loading-state" id="toolhistory-loading" style="display: none; text-align: center; padding: 40px;">
                            <div class="spinner"></div>
                            <div style="margin-top: 10px;">Loading tool history...</div>
                        </div>
                        <div class="empty-state" id="toolhistory-empty">
                            <div class="empty-state-icon">
                                <i class="fas fa-history"></i>
                            </div>
                            <div class="empty-state-text">
                                No tool calls recorded yet.
                            </div>
                        </div>
                        <div id="toolhistory-list" style="display: none;">
                            <!-- Tool history items will be dynamically inserted here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Codebase Tab -->
            <div class="tab-pane" id="codebase">
                <div class="codebase-container" style="width: 100%; height: 100%; position: absolute; top: 0; left: 0; right: 0; bottom: 0;">
                    <div class="loading-state" id="codebase-loading" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                        <div class="spinner"></div>
                        <div>Loading codebase explorer...</div>
                    </div>
                    <div class="empty-state" id="codebase-empty" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                        <div class="empty-state-icon">
                            <i class="fas fa-folder-tree"></i>
                        </div>
                        <div class="empty-state-text">
                            No codebase content available yet.
                        </div>
                    </div>
                    <div class="codebase-frame-container" id="codebase-frame-container" style="display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; right: 0; bottom: 0;">
                        <iframe id="codebase-iframe" style="width: 100%; height: 100%; border: none;" sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-modals allow-top-navigation-by-user-activation"></iframe>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
